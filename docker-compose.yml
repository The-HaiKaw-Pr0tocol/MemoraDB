services:
  memoradb:
    build:
      context: .
      dockerfile: Dockerfile
    image: memoradb:dev
    container_name: memoradb
    restart: unless-stopped
    environment:
      - MEMORADB_PORT=6379
      - MEMORADB_BIND=0.0.0.0
    ports:
      - "${MEMORADB_PORT:-6379}:${MEMORADB_PORT:-6379}"
    healthcheck:
      test: ["CMD", "bash", "-c", "exec 3<>/dev/tcp/127.0.0.1/6379 && echo -e '*1\r\n$4\r\nPING\r\n' >&3 && dd bs=1 count=6 <&3 2>/dev/null | grep -q '+PONG'"]
      interval: 10s
      timeout: 3s
      retries: 5
      start_period: 5s
